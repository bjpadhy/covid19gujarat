<template>
  <v-content>
    <v-container>
      <!--Tweets-->
      <div id="tweets">
        <v-row style="padding-bottom:15px;">
          <v-list-item link>
            <v-list-item-icon>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                width="25pt"
                height="25pt"
                viewBox="0 0 40 40"
                version="1.1"
              >
                <g id="surface2233531">
                  <path
                    style="fill-rule:nonzero;fill:rgb(87.45098%,94.117647%,99.607843%);fill-opacity:1;stroke-width:6;stroke-linecap:butt;stroke-linejoin:round;stroke:rgb(0%,48.235294%,100%);stroke-opacity:1;stroke-miterlimit:10;"
                    d="M 55.692595 150.492349 C 40.808408 150.492349 26.271982 146.962571 13.126601 140.198612 C 28.567207 140.024731 43.121021 134.912639 55.257893 125.401365 L 60.022224 121.680318 L 53.971176 121.558602 C 41.712587 121.332557 30.845044 114.029568 25.92422 103.040308 C 26.91534 103.127248 27.923848 103.162024 28.914968 103.162024 C 32.114373 103.162024 35.279002 102.744711 38.321914 101.910083 L 47.085501 99.527918 L 38.182809 97.736947 C 24.620115 95.00702 14.517647 83.635223 13.178766 70.072528 C 17.212798 71.776559 21.577203 72.750291 25.976385 72.889396 L 33.505419 73.132829 L 27.245714 68.942304 C 18.499515 63.117301 13.283094 53.362594 13.283094 42.842812 C 13.283094 38.339302 14.256826 33.905344 16.099961 29.836536 C 33.470642 49.745875 58.283417 61.847972 84.661119 63.169465 L 87.495374 63.308569 L 86.869403 60.526478 C 86.330373 58.196477 86.052164 55.796924 86.052164 53.379982 C 86.052164 36.078853 100.1365 21.994517 117.420241 21.994517 C 126.0795 21.994517 134.425773 25.611235 140.337717 31.905716 L 141.137568 32.77512 L 142.319957 32.549075 C 148.05802 31.41885 153.604814 29.575715 158.873399 27.054445 C 156.282576 31.975269 152.491977 35.991913 147.727646 38.843556 L 146.023615 39.869452 L 147.588542 42.999304 L 149.153468 42.929752 C 153.396157 42.40811 157.499741 41.521319 161.516385 40.234601 C 158.038771 44.355574 154.09168 48.024457 149.709886 51.189085 L 148.77093 51.849832 L 148.823095 53.014832 C 148.875259 54.423266 148.910035 55.849088 148.910035 57.257521 C 148.910035 103.092472 114.046956 150.492349 55.692595 150.492349 Z M 55.692595 150.492349 "
                    transform="matrix(0.224651,0,0,0.224651,0.68,0.68)"
                  />
                  <path
                    style="fill-rule:nonzero;fill:rgb(27.843137%,53.333333%,78.039216%);fill-opacity:1;stroke-width:6;stroke-linecap:butt;stroke-linejoin:round;stroke:rgb(0%,48.235294%,100%);stroke-opacity:1;stroke-miterlimit:10;"
                    d="M 117.420241 24.150637 C 101.318889 24.150637 88.208285 37.261242 88.208285 53.379982 C 88.208285 55.640431 88.469106 57.883492 88.955972 60.057001 L 90.242689 65.603795 L 84.55679 65.308197 C 58.770283 64.02148 34.444374 52.649683 16.847648 33.870568 C 15.92608 36.7396 15.439215 39.782512 15.439215 42.842812 C 15.439215 52.632295 20.290486 61.726255 28.428102 67.168721 L 40.930124 75.532382 L 25.906832 75.045516 C 22.498771 74.9238 19.108097 74.349994 15.856528 73.341486 C 18.343022 84.400298 27.141385 93.320377 38.600123 95.615602 L 56.405506 99.197545 L 38.878332 103.979264 C 35.852808 104.813891 32.705567 105.265981 29.523551 105.318145 C 34.635643 113.768747 43.816544 119.211212 54.005952 119.402481 L 66.090661 119.628526 L 56.579387 127.088008 C 46.320426 135.121296 34.409598 140.111672 21.681531 141.74615 C 32.427358 146.093168 43.955648 148.353617 55.675207 148.353617 C 112.690686 148.353617 146.753914 102.0318 146.753914 57.257521 C 146.753914 55.866476 146.736526 54.492818 146.666974 53.101773 L 146.562646 50.78916 L 148.440557 49.43289 C 150.683618 47.833188 152.804962 46.076993 154.80459 44.199081 C 153.031007 44.564231 151.222648 44.84244 149.396901 45.068485 L 146.423541 45.433634 L 145.049884 42.755872 L 143.224136 39.173929 L 146.61481 37.000421 C 148.979587 35.574599 151.083544 33.870568 152.891903 31.87094 C 149.58817 33.035941 146.197496 33.974896 142.719882 34.653031 L 140.389881 35.122509 L 138.755402 33.383702 C 133.260773 27.523923 125.488306 24.150637 117.420241 24.150637 M 117.420241 19.855784 C 127.07062 19.855784 135.782043 23.924592 141.902643 30.445118 C 149.536005 28.932356 156.717278 26.150265 163.18564 22.307502 C 160.681758 30.132133 155.743546 36.530943 148.823095 40.686691 L 148.892647 40.79102 C 155.604442 39.97378 161.74243 38.217585 167.706538 35.574599 C 163.203028 42.286394 157.517129 48.198337 150.979215 52.927892 C 151.031379 54.371102 151.066156 55.814312 151.066156 57.274909 C 151.066156 101.562322 117.350689 152.64847 55.692595 152.64847 C 36.756988 152.64847 19.142873 147.101676 4.293462 137.590402 C 6.919061 137.903387 9.596823 138.05988 12.291974 138.05988 C 28.010789 138.05988 42.460274 132.704354 53.9364 123.714722 C 39.26087 123.436513 26.880564 113.733971 22.620487 100.414709 C 24.654891 100.814635 26.758848 101.023292 28.914968 101.023292 C 31.975269 101.023292 34.948628 100.605978 37.748108 99.840903 C 22.41183 96.763215 10.866152 83.217909 10.866152 66.977452 C 10.866152 66.838348 10.866152 66.699243 10.866152 66.54275 C 15.38705 69.06402 20.551307 70.559394 26.045937 70.750663 C 17.056305 64.734391 11.144361 54.47543 11.144361 42.842812 C 11.144361 36.704823 12.796228 30.931984 15.665259 25.993773 C 32.201313 46.268262 56.90976 59.622299 84.765447 61.013344 C 84.209029 58.561627 83.913432 56.00558 83.913432 53.379982 C 83.913432 34.861688 98.919336 19.855784 117.420241 19.855784 Z M 117.420241 19.855784 "
                    transform="matrix(0.224651,0,0,0.224651,0.68,0.68)"
                  />
                  <path
                    style=" stroke:none;fill-rule:nonzero;fill:rgb(87.45098%,94.117647%,99.607843%);fill-opacity:1;"
                    d="M 13.191406 34.488281 C 9.847656 34.488281 6.582031 33.695312 3.628906 32.175781 C 7.097656 32.136719 10.367188 30.988281 13.09375 28.851562 L 14.164062 28.015625 L 12.804688 27.988281 C 10.050781 27.9375 7.609375 26.296875 6.503906 23.828125 C 6.726562 23.847656 6.953125 23.855469 7.175781 23.855469 C 7.894531 23.855469 8.605469 23.761719 9.289062 23.574219 L 11.257812 23.039062 L 9.257812 22.636719 C 6.210938 22.023438 3.941406 19.46875 3.640625 16.421875 C 4.546875 16.804688 5.527344 17.023438 6.515625 17.054688 L 8.207031 17.109375 L 6.800781 16.167969 C 4.835938 14.859375 3.664062 12.667969 3.664062 10.304688 C 3.664062 9.292969 3.882812 8.296875 4.296875 7.382812 C 8.199219 11.855469 13.773438 14.574219 19.699219 14.871094 L 20.335938 14.902344 L 20.195312 14.277344 C 20.074219 13.753906 20.011719 13.214844 20.011719 12.671875 C 20.011719 8.785156 23.175781 5.621094 27.058594 5.621094 C 29.003906 5.621094 30.878906 6.433594 32.207031 7.847656 L 32.386719 8.042969 L 32.652344 7.992188 C 33.941406 7.738281 35.1875 7.324219 36.371094 6.757812 C 35.789062 7.863281 34.9375 8.765625 33.867188 9.40625 L 33.484375 9.636719 L 33.835938 10.339844 L 34.1875 10.324219 C 35.140625 10.207031 36.0625 10.007812 36.964844 9.71875 C 36.183594 10.644531 35.296875 11.46875 34.3125 12.179688 L 34.101562 12.328125 L 34.113281 12.589844 C 34.125 12.90625 34.132812 13.226562 34.132812 13.542969 C 34.132812 23.839844 26.300781 34.488281 13.191406 34.488281 Z M 13.191406 34.488281 "
                  />
                  <path
                    style=" stroke:none;fill-rule:nonzero;fill:rgb(27.843137%,53.333333%,78.039216%);fill-opacity:1;"
                    d="M 27.058594 6.105469 C 28.871094 6.105469 30.617188 6.863281 31.851562 8.179688 L 32.21875 8.570312 L 32.742188 8.464844 C 33.523438 8.3125 34.285156 8.101562 35.027344 7.839844 C 34.621094 8.289062 34.148438 8.671875 33.617188 8.992188 L 32.855469 9.480469 L 33.265625 10.285156 L 33.574219 10.886719 L 34.242188 10.804688 C 34.652344 10.753906 35.058594 10.691406 35.457031 10.609375 C 35.007812 11.03125 34.53125 11.425781 34.027344 11.785156 L 33.605469 12.089844 L 33.628906 12.609375 C 33.644531 12.921875 33.648438 13.230469 33.648438 13.542969 C 33.648438 23.601562 25.996094 34.007812 13.1875 34.007812 C 10.554688 34.007812 7.964844 33.5 5.550781 32.523438 C 8.410156 32.15625 11.085938 31.035156 13.390625 29.230469 L 15.527344 27.554688 L 12.8125 27.503906 C 10.523438 27.460938 8.460938 26.238281 7.3125 24.339844 C 8.027344 24.328125 8.734375 24.226562 9.414062 24.039062 L 13.351562 22.964844 L 9.351562 22.160156 C 6.777344 21.644531 4.800781 19.640625 4.242188 17.15625 C 4.972656 17.382812 5.734375 17.511719 6.5 17.539062 L 9.875 17.648438 L 7.066406 15.769531 C 5.238281 14.546875 4.148438 12.503906 4.148438 10.304688 C 4.148438 9.617188 4.257812 8.933594 4.464844 8.289062 C 8.417969 12.507812 13.882812 15.0625 19.675781 15.351562 L 20.953125 15.417969 L 20.664062 14.171875 C 20.554688 13.683594 20.496094 13.179688 20.496094 12.671875 C 20.496094 9.050781 23.441406 6.105469 27.058594 6.105469 M 27.058594 5.140625 C 22.902344 5.140625 19.53125 8.511719 19.53125 12.671875 C 19.53125 13.261719 19.597656 13.835938 19.722656 14.386719 C 13.464844 14.074219 7.914062 11.074219 4.199219 6.519531 C 3.554688 7.628906 3.183594 8.925781 3.183594 10.304688 C 3.183594 12.917969 4.511719 15.222656 6.53125 16.574219 C 5.296875 16.53125 4.136719 16.195312 3.121094 15.628906 C 3.121094 15.664062 3.121094 15.695312 3.121094 15.726562 C 3.121094 19.375 5.714844 22.417969 9.160156 23.109375 C 8.53125 23.28125 7.863281 23.375 7.175781 23.375 C 6.691406 23.375 6.21875 23.328125 5.761719 23.238281 C 6.71875 26.230469 9.5 28.410156 12.796875 28.472656 C 10.21875 30.492188 6.972656 31.695312 3.441406 31.695312 C 2.835938 31.695312 2.234375 31.660156 1.644531 31.589844 C 4.980469 33.726562 8.9375 34.972656 13.191406 34.972656 C 27.042969 34.972656 34.617188 23.496094 34.617188 13.546875 C 34.617188 13.21875 34.609375 12.894531 34.597656 12.570312 C 36.066406 11.507812 37.34375 10.179688 38.355469 8.671875 C 37.015625 9.265625 35.636719 9.660156 34.128906 9.84375 L 34.113281 9.820312 C 35.667969 8.886719 36.777344 7.449219 37.339844 5.691406 C 35.886719 6.554688 34.273438 7.179688 32.558594 7.519531 C 31.183594 6.054688 29.226562 5.140625 27.058594 5.140625 Z M 27.058594 5.140625 "
                  />
                </g>
              </svg>
            </v-list-item-icon>
            <v-list-item-content>
              <v-list-item-title
                class="headline font-regular"
                style="color:rgb(108, 117, 125); font-family: Archivo, sans-serif !important;"
                >Twitter</v-list-item-title
              >
            </v-list-item-content>
          </v-list-item>
        </v-row>
        <v-item-group>
          <v-container>
            <v-row>
              <v-col v-for="(tweet, t) in tweets" :key="t" cols="12" md="4">
                <v-item>
                  <v-card
                    class="mx-auto"
                    color="#26c6da"
                    max-height="600"
                    dark
                    max-width="400"
                  >
                    <v-img
                      v-if="tweet.images.length !== 0"
                      :src="tweet.images[0]"
                      height="200px"
                    ></v-img>
                    <v-card-text class="subtitle-1">
                      {{ tweet.text }}
                    </v-card-text>
                    <v-card-actions>
                      <v-list-item class="grow">
                        <v-list-item-content>
                          <v-list-item-title>{{
                            tweet.screenName
                          }}</v-list-item-title>
                        </v-list-item-content>
                        <v-row align="center" justify="end">
                          <v-icon class="mr-1">mdi-heart</v-icon>
                          <span class="subheading mr-2">{{
                            tweet.favoriteCount
                          }}</span>
                          <span class="mr-1">·</span>
                          <v-icon class="mr-1">mdi-share-variant</v-icon>
                          <span class="subheading">{{
                            tweet.retweetCount
                          }}</span>
                        </v-row>
                      </v-list-item>
                    </v-card-actions>
                  </v-card>
                </v-item>
              </v-col>
            </v-row>
          </v-container>
        </v-item-group>
      </div>
      <!--News-->
      <div id="news">
        <v-row style="padding-bottom:15px;">
          <v-list-item link>
            <v-list-item-icon>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                width="25pt"
                height="25pt"
                viewBox="0 0 64 64"
                version="1.1"
              >
                <g id="surface8650320">
                  <path
                    style=" stroke:none;fill-rule:nonzero;fill:rgb(96.862745%,96.862745%,98.431373%);fill-opacity:1;"
                    d="M 54.851562 55 L 9.101562 55 C 6.550781 55 4.5 52.949219 4.5 50.398438 L 4.5 11.300781 C 4.5 10.050781 5.550781 9 6.800781 9 L 48 9 C 49.25 9 50.300781 10.050781 50.300781 11.300781 L 50.300781 50.449219 C 50.300781 52.949219 52.351562 55 54.851562 55 C 57.398438 55 59.449219 52.949219 59.449219 50.398438 L 59.449219 25.101562 C 59.449219 23.851562 58.398438 22.800781 57.148438 22.800781 L 54.851562 22.800781 "
                  />
                  <path
                    style=" stroke:none;fill-rule:nonzero;fill:rgb(87.058824%,87.45098%,90.196078%);fill-opacity:1;"
                    d="M 11.5 15.949219 L 43.050781 15.949219 C 43.898438 15.949219 44.550781 16.601562 44.550781 17.449219 L 44.550781 25.898438 C 44.550781 26.75 43.898438 27.398438 43.050781 27.398438 L 11.5 27.398438 C 10.648438 27.398438 10 26.75 10 25.898438 L 10 17.449219 C 10 16.601562 10.648438 15.949219 11.5 15.949219 Z M 54.851562 55 C 57.398438 55 59.449219 52.949219 59.449219 50.398438 L 59.449219 25.101562 C 59.449219 23.851562 58.398438 22.800781 57.148438 22.800781 L 50.25 22.800781 L 50.25 50.398438 C 50.300781 52.949219 52.351562 55 54.851562 55 Z M 54.851562 55 "
                  />
                  <path
                    style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,48.235294%,100%);fill-opacity:1;"
                    d="M 54.851562 56.5 L 9.101562 56.5 C 5.75 56.5 3 53.75 3 50.398438 L 3 11.300781 C 3 9.199219 4.699219 7.5 6.800781 7.5 L 48 7.5 C 50.101562 7.5 51.800781 9.199219 51.800781 11.300781 L 51.800781 50.449219 C 51.800781 52.148438 53.199219 53.550781 54.898438 53.550781 C 56.601562 53.550781 58 52.148438 58 50.449219 L 58 25.101562 C 58 24.648438 57.648438 24.300781 57.199219 24.300781 L 54.898438 24.300781 C 54.050781 24.300781 53.398438 23.648438 53.398438 22.800781 C 53.398438 21.949219 54.050781 21.300781 54.898438 21.300781 L 57.199219 21.300781 C 59.300781 21.300781 61 23 61 25.101562 L 61 50.398438 C 60.949219 53.800781 58.199219 56.5 54.851562 56.5 Z M 6.800781 10.5 C 6.351562 10.5 6 10.851562 6 11.300781 L 6 50.449219 C 6 52.148438 7.398438 53.550781 9.101562 53.550781 L 49.648438 53.550781 C 49.101562 52.648438 48.800781 51.601562 48.800781 50.449219 L 48.800781 11.300781 C 48.800781 10.851562 48.449219 10.5 48 10.5 Z M 6.800781 10.5 "
                  />
                  <path
                    style=" stroke:none;fill-rule:nonzero;fill:rgb(87.058824%,87.45098%,90.196078%);fill-opacity:1;"
                    d="M 20.601562 36.449219 L 11.5 36.449219 C 10.648438 36.449219 10 35.800781 10 34.949219 C 10 34.101562 10.648438 33.449219 11.5 33.449219 L 20.601562 33.449219 C 21.449219 33.449219 22.101562 34.101562 22.101562 34.949219 C 22.101562 35.800781 21.449219 36.449219 20.601562 36.449219 Z M 20.601562 49.351562 L 11.5 49.351562 C 10.648438 49.351562 10 48.699219 10 47.851562 C 10 47 10.648438 46.351562 11.5 46.351562 L 20.601562 46.351562 C 21.449219 46.351562 22.101562 47 22.101562 47.851562 C 22.101562 48.699219 21.449219 49.351562 20.601562 49.351562 Z M 20.601562 42.851562 L 11.5 42.851562 C 10.648438 42.851562 10 42.199219 10 41.351562 C 10 40.5 10.648438 39.851562 11.5 39.851562 L 20.601562 39.851562 C 21.449219 39.851562 22.101562 40.5 22.101562 41.351562 C 22.101562 42.199219 21.449219 42.851562 20.601562 42.851562 Z M 20.601562 42.851562 "
                  />
                  <path
                    style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,48.235294%,100%);fill-opacity:1;"
                    d="M 43 49.550781 L 29 49.550781 C 28.148438 49.550781 27.5 48.898438 27.5 48.050781 L 27.5 34.300781 C 27.5 33.449219 28.148438 32.800781 29 32.800781 L 43 32.800781 C 43.851562 32.800781 44.5 33.449219 44.5 34.300781 L 44.5 48.050781 C 44.5 48.851562 43.851562 49.550781 43 49.550781 Z M 30.5 46.550781 L 41.5 46.550781 L 41.5 35.800781 L 30.5 35.800781 Z M 30.5 46.550781 "
                  />
                </g>
              </svg>
            </v-list-item-icon>
            <v-list-item-content>
              <v-list-item-title
                class="headline font-regular"
                style="color:rgb(108, 117, 125); font-family: Archivo, sans-serif !important;"
                >Latest News</v-list-item-title
              >
            </v-list-item-content>
          </v-list-item>
        </v-row>
        <v-card flat class="mx-auto" width="100%">
          <v-col v-for="(item, i) in news" :key="i" cols="12">
            <v-card hover color="rgba(108, 117, 125, 0.1)">
              <div class="d-flex flex-no-wrap">
                <v-avatar class="ma-3" size="125" tile>
                  <v-img :src="item.thumbnail"></v-img>
                </v-avatar>
                <div>
                  <v-card-title
                    class="headline"
                    v-text="item.title"
                  ></v-card-title>
                  <v-card-subtitle
                    v-text="item.datePublished"
                  ></v-card-subtitle>
                  <v-card-text v-text="item.description"></v-card-text>
                </div>
              </div>
              <v-spacer></v-spacer>
              <v-card-actions>
                <v-spacer></v-spacer>
                <v-btn right icon @click="item.show = !item.show">
                  <v-icon>{{
                    item.show ? "mdi-chevron-up" : "mdi-chevron-down"
                  }}</v-icon>
                </v-btn>
              </v-card-actions>
              <v-expand-transition>
                <div v-show="item.show">
                  <v-divider></v-divider>
                  <v-card-text v-text="item.body"></v-card-text>
                </div>
              </v-expand-transition>
            </v-card>
          </v-col>
        </v-card>
      </div>
    </v-container>
  </v-content>
</template>

<script>
import moment from "moment";
import axios from "axios";

export default {
  name: "NewsFeed",

  mounted() {
    this.getData();
  },

  data: () => ({
    news: [],
    tweets: [],
  }),

  methods: {
    async getData() {
      axios
        .all([
          axios.get(
            "https://twitscrapeapi.herokuapp.com/api/by-list/bjpadhy/corona-gujarat/6"
          ),
          axios.get(
            "https://contextualwebsearch-websearch-v1.p.rapidapi.com/api/Search/NewsSearchAPI?fromPublishedDate=1%252F1%252F2020&autoCorrect=false&pageNumber=1&pageSize=10&q=corona%20gujarat&safeSearch=true",
            {
              method: "GET",
              headers: {
                "x-rapidapi-host":
                  "contextualwebsearch-websearch-v1.p.rapidapi.com",
                "x-rapidapi-key":
                  "f5b75795admshf24e083a78ee561p13a059jsn586dd0c7c46f",
              },
            }
          ),
        ])
        .then(
          axios.spread((tweets, news) => {
            this.tweets = [];
            this.news = [];
            tweets.data.forEach((item) => {
              let tempObj = {};
              tempObj["screenName"] = item.screenName;
              tempObj["text"] = item.text;
              tempObj["images"] = [];
              item.images.forEach((image) => {
                tempObj.images.push(image);
              });
              tempObj["time"] = item.time;
              tempObj["favoriteCount"] = item.favoriteCount;
              tempObj["retweetCount"] = item.retweetCount;
              this.tweets.push(tempObj);
            });
            news.data.value.forEach((value) => {
              let tempObj = {};
              tempObj["datePublished"] = moment(value.datePublished).format(
                "MMMM Do YYYY, h:mm:ss a"
              );
              tempObj["title"] = value.title.replace(/(<([^>]+)>)/gi, "");
              tempObj["thumbnail"] = value.image.thumbnail;
              tempObj["body"] = value.body;
              tempObj["description"] = value.description.replace(
                /(<([^>]+)>)/gi,
                ""
              );
              tempObj["url"] = value.url;
              tempObj["show"] = false;
              this.news.push(tempObj);
            });
          })
        )
        .catch((error) => {
          console.log(error);
        });
    },
  },
};
</script>
<style>
#news {
  font-family: "Archivo", sans-serif !important;
}
</style>
